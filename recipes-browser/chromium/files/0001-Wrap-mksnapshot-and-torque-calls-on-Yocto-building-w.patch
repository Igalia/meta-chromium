From 95cf620f47b7a6c155522b0cb0fb23551f9d6272 Mon Sep 17 00:00:00 2001
From: Jose Dapena Paz <jose.dapena@lge.com>
Date: Tue, 12 Feb 2019 19:00:28 +0100
Subject: Wrap mksnapshot and torque calls on Yocto building with qemu.

The patch below makes the V8 binaries run during the build be invoked through
QEMU, as they are built for the target.

Based on original patch from Raphael Kubo da Costa <raphael.kubo.da.costa@intel.com>

Upstream-Status: Inappropriate [embedded specific]

diff --git a/BUILD.gn b/BUILD.gn
index 16e0b60ca7..e4eede2721 100644
--- a/BUILD.gn
+++ b/BUILD.gn
@@ -920,6 +920,7 @@ action("run_torque") {
   }
 
   args = [
+    "./v8-qemu-wrapper.sh",
     "./" + rebase_path(get_label_info(":torque($v8_generator_toolchain)",
                                       "root_out_dir") + "/torque",
                        root_build_dir),
@@ -966,6 +967,7 @@ action("generate_bytecode_builtins_list") {
     ":bytecode_builtins_list_generator($v8_generator_toolchain)",
   ]
   args = [
+    "./v8-qemu-wrapper.sh",
     "./" + rebase_path(
             get_label_info(
                     ":bytecode_builtins_list_generator($v8_generator_toolchain)",
@@ -1009,6 +1011,7 @@ template("run_mksnapshot") {
     data = []
 
     args = [
+      "./v8-qemu-wrapper.sh",
       "./" + rebase_path(get_label_info(":mksnapshot($v8_snapshot_toolchain)",
                                         "root_out_dir") + "/mksnapshot",
                          root_build_dir),
-- 
2.17.1

